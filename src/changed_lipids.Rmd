---
title: "Significant Lipids correlated with top RNA-seq genes"
author: "Timothy Yu"
date: "6/24/24"
output: html_document
---
```{r setup, include=FALSE}
library(tidyverse)
library(viridis)
require(cowplot)
theme_set(theme_cowplot())
```

```{r}
top50gene_x_liver_lipid = read.csv('../processed_data/correlations/top50gene_x_liver_lipid.csv', 
                                   header = TRUE, stringsAsFactors = FALSE, check.names = FALSE)
```

```{r}
top50gene_x_liver_lipid_filtered = top50gene_x_liver_lipid %>% 
  filter(bicor > 0.7, adj_pval < 0.05) %>%
  group_by(Liver_lipid) %>%
  mutate(Num_significant_corrs = n()) %>%
  ungroup() %>% 
  mutate(Lipid_class = ifelse(grepl("^PE\\.O\\.|^PE\\.P\\.", Liver_lipid),
                              sub("\\.", "_", str_extract(Liver_lipid, "^PE\\..")),
                              str_extract(Liver_lipid, "^[^.]+"))) %>% drop_na()
write.csv('../processed_data/correlations/plot_sig_top50gene_x_liver_lipid.csv')
```
